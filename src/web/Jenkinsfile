@Library('pipeline-library')

/*Map tasks = [failFast: false]

tasks['x86'] = { ->
    node {
        multiArchFlow('x86')
    }
}
tasks['arm'] = { ->
    node {
        multiArchFlow('arm')
    }
}*/

node {
    multiArchFlow('arm')
}

// Run both task in parallel
//parallel(tasks)

def multiArchFlow(String arch) {

    tech = "nodejs"

    parallel (
        "test": {
            sh "echo test"
        },
        "linter": {
            sh "echo linter"
        }
    )

    parallel (
        checkout(tech),
    
        downloadTooling(tech)
    )

    build(tech)
}